<!doctype html>
<html amp lang="en">

<!-- Mirrored from arindamchat.wordpress.com/2013/06/07/custom-search-solutions-for-sharepoint-2010-fulltextsqlquery/amp/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 21 Jun 2017 13:52:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQuery" />
<meta property="og:url" content="../index.html" />
<meta property="og:description" content="Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQueryIf you are building a custom search solution based on SharePoint 2010 you might want to build your own custom query to query the …" />
<meta property="article:published_time" content="2013-06-07T08:09:00+00:00" />
<meta property="article:modified_time" content="2014-08-13T10:23:26+00:00" />
<meta property="og:site_name" content="Arindam&#039;s Blog" />
<meta property="og:image" content="../../../../../../arindamchat.files.wordpress.com/2013/06/0c922-11.jpg" />
<meta property="og:image:secure_url" content="../../../../../../arindamchat.files.wordpress.com/2013/06/0c922-11.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:text:title" content="Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQuery" />
<meta name="twitter:image" content="../../../../../../arindamchat.files.wordpress.com/2013/06/0c922-1165c1.jpg?w=1400" />
<meta name="twitter:card" content="photo" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
	<title>Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQuery &#8211; Arindam&#039;s Blog</title>
		<link rel="canonical" href="../index.html" />
			<script custom-element="amp-ad" src="../../../../../../cdn.ampproject.org/v0/amp-ad-0.1.js" async></script>
		<script src="../../../../../../cdn.ampproject.org/v0.js" async></script>
			<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic">
		<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"BlogPosting","mainEntityOfPage":"https:\/\/arindamchat.wordpress.com\/2013\/06\/07\/custom-search-solutions-for-sharepoint-2010-fulltextsqlquery\/","publisher":{"@type":"Organization","name":"Arindam&#039;s Blog","logo":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/blavatar\/6fec2d116f8d27e63ee3e0e9473feaa7?s=60&d=https%3A%2F%2Fs2.wp.com%2Fi%2Ffavicons%2Fapple-touch-icon-60x60.png","width":60,"height":60}},"headline":"Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQuery","datePublished":"2013-06-07T08:09:00+00:00","dateModified":"2014-08-13T10:23:26+00:00","author":{"@type":"Person","name":"Arindam C"},"image":{"@type":"ImageObject","url":"https:\/\/arindamchat.files.wordpress.com\/2013\/06\/0c922-11.jpg","width":645,"height":420}}</script>
		<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}

.amp-wp-unknown-size img {
	/** Worst case scenario when we can't figure out dimensions for an image. **/
	/** Force the image into a box of fixed dimensions and use object-fit to scale. **/
	object-fit: contain;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 712px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: 'Merriweather', 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}

/* Site Icon */

.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 1.5em;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( ../../../../../../s2.wp.com/wp-content/plugins/amp/assets/images/placeholder-icon.png) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
				/* WordAds */
		.wpcnt {
			text-align: center;
			line-height: 0;
			display: block;
			clear: both;
			margin: 1em 0;
		}

		.rtl .wpcnt {
			direction: ltr;
		}

		.wpa {
			position: relative;
			display: inline-block;
			max-width: 100%;
			text-align: left;
			padding: 10px 0 0;
			min-width: 300px;
			-webkit-transform: translate3d(0, 0, 0);
			transform: translate3d(0, 0, 0);
		}

		.wpa-about {
			position: absolute;
			top: 5px;
			left: 0;
			right: 0;
			display: block;
			min-width: 160px;
			border-bottom: none;
			font: 10px/1 "Open Sans", Arial, sans-serif;
			text-align: left;
			text-decoration: none;
			opacity: 0.85;
		}

		.wpa .u>div, .wpadvert>div>* {
			display: block;
			margin-top: 5px;
			margin-bottom: 1em;
		}

		div.wpa>div {
			margin-top: 10px;
		}/* Inline styles */
.amp-wp-inline-2b4d2be2e69fb2a80f3ea04ab4df1142{text-align:left;}.amp-wp-inline-d28849128064adecbd4c9243499b3976{color:#c00000;font-size:12pt;}.amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4{margin:0 0 .0001pt;}.amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0{font-family:&#039;font-size:10pt;}.amp-wp-inline-be5383467ed797f8262ed0a4261cfa75{color:blue;font-size:12pt;}.amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57{margin-left:.5in;text-indent:-.25in;}.amp-wp-inline-659e7702c3208302cb0833d991c5b3f9{font-family:Symbol;}.amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979{font-family:&#039;font-size:7pt;}.amp-wp-inline-cb08775e0ae4e830b87359c9f78462e6{color:#c00000;}.amp-wp-inline-9a8696467202e91c01706d4c3510dd46{clear:both;text-align:center;}.amp-wp-inline-984b56f41b49a5d1dd7e19b98440ddd0{margin-left:1em;margin-right:1em;}.amp-wp-inline-6c25bc80003b7597f4f448c381d95fdc{color:#c00000;font-family:Symbol;}.amp-wp-inline-a2049b01cc6692194134e712d705a590{background-color:white;background-position:initial initial;background-repeat:initial initial;font-family:Arial, sans-serif;font-size:10.5pt;}.amp-wp-inline-5c8b5dd2518dbe7eb1c953457977dd1a{color:#00b050;font-size:18pt;}	</style>
</head>

<body class="">

<header id="#top" class="amp-wp-header">
	<div>
		<a href="../../../../../index.html">
						Arindam&#039;s Blog		</a>
	</div>
</header>

<article class="amp-wp-article">

	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">Custom Search Solutions for SharePoint 2010 &#8211; FullTextSqlQuery</h1>
				<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/e1684c9e7b0368aff778803d73e2c883?s=24&amp;d=identicon&amp;r=g" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">Arindam C</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2013-06-07T08:09:00+00:00">
		4 years ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<div dir="ltr" class="amp-wp-inline-2b4d2be2e69fb2a80f3ea04ab4df1142">
<div class="MsoNoSpacing">
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-5c8b5dd2518dbe7eb1c953457977dd1a">Custom Search Solutions for SharePoint 2010 – FullTextSqlQuery</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">If you are building a custom search solution based on SharePoint 2010 you might want to build your own custom query to query the SharePoint index. If you do you probably need to use the <b>FullTextSqlQuery</b> class.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">FullTextSqlQuery is available in two different namespaces. There is Microsoft.SharePoint.Search.Query.FullTextSqlQuery for SharePoint Foundation and there is Microsoft.Office.Server.Search.Query.FullTextSqlQuery for SharePoint Server. Be aware of which version of SharePoint you are running and use the right one, or your query won’t return the results you expect. So if you are running SharePoint Server you need to use Microsoft.Office.Server.Search.Query.FullTextSqlQuery.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Microsoft.Office.Server.Search.Query.FullTextSqlQuery</span></b></div>
<div class="MsoNoSpacing">The “FullTextSqlQuery” object’s constructor requires an object that has context but don’t be fooled. This context will not be the context in which your query will search on. Scopes are used for that are I will be explaining scopes a little later on. </div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Query Text</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">The “FullTextSqlQuery” object has a “QueryText” property which takes a query very similar to a generic SQL query. Here is a list of minor differences for those who are interested:</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->There is only one table to search on – “Scope” and this table is suffixed by parenthesis.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->You cannot search on all columns using *. You have to specify the column names you require.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->There are no aggregate functions eg. ‘Count’</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->“LIKE” doesn’t work by default. You can use “CONTAINS(Title, ‘SharePoint’). But if you want to use LIKE ,<span class="amp-wp-inline-a2049b01cc6692194134e712d705a590"> you need to set</span> the “<b><i>Reduce storage requirements for text properties by using a hash for comparison</i></b>” option in the settings of the <b>Managed Property</b> to make the LIKE predicate work.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-6c25bc80003b7597f4f448c381d95fdc">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->The comparable commands are Equals “=”, Not Equals “!=”, Contains “CONTAINS(ColumnName, ‘Value’)” and FREETEXT(*, ‘value’) which allows you to search on all columns. <span class="amp-wp-inline-cb08775e0ae4e830b87359c9f78462e6">NOTE: You cannot put spaces in any of these value objects. Replace all spaces with the ‘+’ character to search multiple words. And use the ‘*’ character in the values as a wildcard – WILDCARDS ONLY WORK IN SP 2010!.</span></div>
<div class="MsoNoSpacing"><span class="amp-wp-inline-cb08775e0ae4e830b87359c9f78462e6">So here is an example of what your QueryText could look like:</span></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b>SELECT Title, Description, Path FROM SCOPE() WHERE CONTAINS(Title, ‘SharePoint’) AND IsDocument = 1 ORDER BY Title</b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Query Properties</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">There are some properties on the “FullTextSqlQuery” object that you will need to set.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->ResultTypes. This is an enum of type Microsoft.Office.Server.Search.Query.ResultType. I’ve only ever used the “RelevantResults” value. I’ve tested the rest but I don’t get any results using them so not sure what they are for.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->TrimDuplicates. As the name states.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->StartRow. Used for paging. The index of the first item to return. <span class="amp-wp-inline-cb08775e0ae4e830b87359c9f78462e6">NOTE: If you’re using the API this index starts at 0 but if you are using the webservice to call a Query the index starts at 1.</span></div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->RowLimit. Used for paging. The amount of results the query must return.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->There are some more properties you can go and check.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Search Columns for Query</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">If you want to know what columns you can select on you can see this in your Shared Services Provider in MOSS 2007 or in Search Service Applications for the latter versions. Go to “Search settings” option under “Search”. And click on the “Metadata properties” item in the quick launch menu under “Queries and Results”. On this screen you can see all the managed properties and their crawled property mappings. Check about my other post “<b>Metadata Property Mapping</b>” for more information (the below screenshot in from MOSS 2007 though).</div>
<p></p>
<div class="MsoNoSpacing">Ideally if you have created new Managed Property and correctly configured, you can use them also in search provided Crawling is done on them.</div>
</div>
<div class="MsoNoSpacing"></div>
<div class="separator amp-wp-inline-9a8696467202e91c01706d4c3510dd46"><a href="../../../../../../arindamchat.files.wordpress.com/2013/06/0c922-11.jpg" class="amp-wp-inline-984b56f41b49a5d1dd7e19b98440ddd0"><amp-img height="260" src="../../../../../../arindamchat.files.wordpress.com/2013/06/0c922-11f774.jpg?w=400&amp;h=260" width="400" sizes="(min-width: 400px) 400px, 100vw" class="amp-wp-enforced-sizes"></amp-img></a></div>
<div class="MsoNoSpacing"><!--[endif]--></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Scopes used in Query</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">Scopes allow us to search in specific areas of SharePoint. You can only create a scope inside a web application and a site collection. So if you have multiple web applications and multiple site collections you can make your search specific to one of multiple of these. If you don’t specify a scope the search will return results from all web application and all site collections. This optimizes your search greatly as the scopes index all your results. <span class="amp-wp-inline-cb08775e0ae4e830b87359c9f78462e6">NOTE: For your scope to be visible from your “FullTextSqlQuery” it needs to be Shared.</span></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Crawling and Indexing</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">Don’t forget that until you do a crawl newly added things will not be indexed and will not be returned in the Search Query  not in the default SharePoint OOB search either ….</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Query Results</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">The results of a “FullTextSqlQuery” are returned in the form of a “ResultTableCollection” from the “Execute” method. In order to get your results from this collection you need to the index the collection with your ResultType like so “fullTextSqlQuery.Execute()[ResultType.RelevantResults];”.</div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->The ResultTable is not very straight forward and it might be messy to get results out in a particular format. </div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->First you need to call the Read() function inside a while loop and then use a for loop to get the index of each result item. </div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->You then use two methods on the table: “GetName()” and “GetValue()”. </div>
<div class="MsoNoSpacing amp-wp-inline-7f5c37e819d5de45deabbb56e6a78f57"><!--[if !supportLists]--><span class="amp-wp-inline-659e7702c3208302cb0833d991c5b3f9">·<span class="amp-wp-inline-f35a7a481c12b35f9acbe5defc15c979">         </span></span><!--[endif]-->Each of these methods takes an index parameter. You need to compare the name to the name that you are looking for and set the value for the object. </div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">Here’s a code sample:</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><i><span>while (resultTable.Read())</span></i></div>
<div class="MsoNoSpacing"><i><span>{</span></i></div>
<div class="MsoNoSpacing"><i><span>  for (int i = 0; i &lt; resultTable.FieldCount; i++)</span></i></div>
<div class="MsoNoSpacing"><i><span>  {</span></i></div>
<div class="MsoNoSpacing"><i><span>      string name = resultTable.GetName(i);</span></i></div>
<div class="MsoNoSpacing"><i><span>      object objValue = resultTable.GetValue(i);</span></i></div>
<div class="MsoNoSpacing"><i><span>      string value = string.Empty;</span></i></div>
<div class="MsoNoSpacing"><i><span>      if (objValue != null)</span></i></div>
<div class="MsoNoSpacing"><i><span>      {</span></i></div>
<div class="MsoNoSpacing"><i><span>        value = objValue.ToString();</span></i></div>
<div class="MsoNoSpacing"><i><span>      }</span></i></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><i><span>      if (name == SearchProperties.Title.ToString().ToUpper(CultureInfo.CurrentCulture))</span></i></div>
<div class="MsoNoSpacing"><i><span>      {</span></i></div>
<div class="MsoNoSpacing"><i><span>        sr.Title = value;</span></i></div>
<div class="MsoNoSpacing"><i><span>      }                        </span></i></div>
<div class="MsoNoSpacing"><i><span>   }</span></i></div>
<div class="MsoNoSpacing"><i><span>}</span></i></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Bugs</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">Yup, like most complex software out there, even Microsoft software, there are bugs. So far I have picked up two.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">1. Sort by Author does not return desired results. The Author managed property is linked to a Mail and Office category field. For some reason if you sort by this property it adds a null row after every result so your count will double. As far as I’m aware this is a bug in 2007 and 2010.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">2. ModifedBy and CreatedBy are empty. Although these fields exist inside the SPItem, you will not be able to retrieve them using the FullTextSqlQuery object. It seems that these fields are not indexable and they will always return null.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">3. Heard that property ModifiedBy is not set Retrievable. But you can use is as below, haven’t tried it though.</div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing">Open SharePoint PowerShell, and type following to fix:<br/><!--[if !supportLineBreakNewLine]--><br/><!--[endif]--></div>
<div class="MsoNoSpacing"><i><span class="amp-wp-inline-be5383467ed797f8262ed0a4261cfa75">$mp = Get-SPEnterpriseSearchServiceApplication | Get-SPEnterpriseSearchMetadataManagedProperty -identity ModifiedBy</span><br/>$mp.Retrievable = $true<br/>$mp.Update()</i></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Resources (MOSS only but this has not been changed much in SP 2010 either)</span></b></div>
<div class="MsoNoSpacing">1. <a href="http://community.bamboosolutions.com/blogs/bambooteamblog/archive/2009/04/24/wss-custom-search.aspx">http://community.bamboosolutions.com/blogs/bambooteamblog/archive/2009/04/24/wss-custom-search.aspx</a></div>
<div class="MsoNoSpacing">2. <a href="http://blogs.msdn.com/b/varun_malhotra/archive/2008/08/16/moss-search-with-order-by-clause-doesn-t-return-all-results.aspx">http://blogs.msdn.com/b/varun_malhotra/archive/2008/08/16/moss-search-with-order-by-clause-doesn-t-return-all-results.aspx</a></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Sample Query Code:</span></b></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">1.</span></b></div>
<div><span>using</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">(</span><span>SPSite</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">siteCollection =<span class="apple-converted-space"> </span></span><span>new</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span>SPSite</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">(siteCollectionUrl))</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">{</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>// create a new FullTextSqlQuery class – use property intializers to set query</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"></span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>FullTextSqlQuery</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">myQuery =<span class="apple-converted-space"> </span></span><span>new</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span>FullTextSqlQuery</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">(siteCollection)</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">    {</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">        QueryText =<span class="apple-converted-space"> </span></span><span>“SELECT Title, Path, Color, Size, Quantity, Description, Rank, Size FROM SCOPE() WHERE \”scope\” = ‘My Scope’ AND CONTAINS(Color, ‘ant*’)”</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">,</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">        ResultTypes =<span class="apple-converted-space"> </span></span><span>ResultType</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">.RelevantResults</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">    };</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>// execute the query and load the results into a datatable</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"></span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>ResultTableCollection</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">queryResults = myQuery.Execute();</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>ResultTable</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">queryResultsTable = queryResults[</span><span>ResultType</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">.RelevantResults];</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">   <span class="apple-converted-space"> </span></span><span>DataTable</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">queryDataTable =<span class="apple-converted-space"> </span></span><span>new</span><span class="apple-converted-space"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0"> </span></span><span>DataTable</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">();</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">    queryDataTable.Load(queryResultsTable,<span class="apple-converted-space"> </span></span><span>LoadOption</span><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">.OverwriteChanges);</span></div>
<div class="amp-wp-inline-a98181a7b4bc6c0ab8e3387ffbd89ef4"><span class="amp-wp-inline-c7cfcdf43446d40acc269e12b6963fb0">}</span></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">2.</span></b></div>
<div class="MsoNoSpacing"></div>
<div><span>using (SPSite site = new SPSite(“http://localhost&amp;#8221;))</span></div>
<div><span>{</span></div>
<div><span>  using (FullTextSqlQuery query = new FullTextSqlQuery(site))</span></div>
<div><span>  {</span></div>
<div><span>    query.QueryText = “SELECT Title, FooText FROM scope() WHERE FooText = ‘Foo2′”;</span></div>
<div><span>    query.ResultTypes = ResultType.RelevantResults;</span></div>
<div></div>
<div><span>    //result output here…</span></div>
<div><span>  }</span></div>
<div><span>}</span></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"></div>
<div class="MsoNoSpacing"><b><span class="amp-wp-inline-d28849128064adecbd4c9243499b3976">Query for words starting with one specific character</span></b></div>
<div class="MsoNoSpacing"></div>
<div><span>FullTextSqlQuery oSearchQuery = new FullTextSqlQuery(SPContext.Current.Site);</span></div>
<div><span>            oSearchQuery.ResultTypes = ResultType.RelevantResults;</span></div>
<div><span>            oSearchQuery.RowLimit = 0;</span></div>
<div><span>            oSearchQuery.EnablePhonetic = true;</span></div>
<div><span>            oSearchQuery.TrimDuplicates = false;</span></div>
<div><span>            oSearchQuery.EnableStemming = true;</span></div>
<div><span>            string SQL = @”select ID,Title from scope() where “”scope””=’PortalConhecimento_Glossario’ AND Title LIKE ‘” + sInicial + “%’ ORDER BY Title ASC”;</span></div>
<div><span>            oSearchQuery.QueryText = SQL;</span></div>
<div></div>
<div><span>            ResultTableCollection searchResults = oSearchQuery.Execute();</span></div>
<div><span>            if (searchResults.Exists(ResultType.RelevantResults))</span></div>
<p></p>
<div><span><span>                </span>rt = searchResults[ResultType.RelevantResults];</span></div>
</div>
</div>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<span class="wpa-about">Advertisements</span>
				<div class="u">
					<amp-ad width="300" height="250" type="pubmine" data-adsafe="0" data-section="2" data-siteid="2694" data-wordads="0"><div placeholder="" class="amp-wp-iframe-placeholder"></div>
					</amp-ad></div>
			</div>
		</div>	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="../../../../../category/microsoft-technologies/index.html" rel="category tag">Microsoft Technologies</a>	</div>

		<div class="amp-wp-meta amp-wp-comments-link">
		<a href="../index.html#respond">
			Leave a Comment		</a>
	</div>
	</footer>

</article>

<footer class="amp-wp-footer">
	<div>
		<h2>Arindam&#039;s Blog</h2>
		<p>
			<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
		</p>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>

	<amp-pixel src="../../../../../../pixel.wp.com/b9aed.gif?rand=RANDOM&amp;host=arindamchat.wordpress.com&amp;ref=DOCUMENT_REFERRER&amp;amp=1&amp;blog=72867871&amp;v=wpcom&amp;tz=0&amp;user_id=0&amp;post=15&amp;subd=arindamchat"></amp-pixel>
	<amp-pixel src="../../../../../../pixel.wp.com/bdc10.gif?rand=RANDOM&amp;v=wpcom-no-pv&amp;crypt=UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRLWhqanhKV3x0UkRILjFhcVJaLG0%2FMEx1NjN1W0krTU9WPXRzXTdKMFpwTT1mRVEzZkNXa01aP2VJREdMOC1peDl4VXFLLEFBLkw5c1hbWCwzWn54ZXBXdC9sN35wWGcycVRpV1d6YmVUX0F1PTRfckVZST9ZWnZDTUlNUDkxNXFlcnlNMFc5UG1xWjlKMjQ0cVt8Q2pbY052MXpCVHJL"></amp-pixel>
	
</body>

<!-- Mirrored from arindamchat.wordpress.com/2013/06/07/custom-search-solutions-for-sharepoint-2010-fulltextsqlquery/amp/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 21 Jun 2017 13:52:45 GMT -->
</html>
